[build]
  publish = ".tanstack/start/build/client-dist"
  command = "npm run build"

[build.environment]
  NODE_VERSION = "22"

# Using TanStack Start + Nitro. Netlify will package functions from .netlify/functions-internal automatically.

# Template configuration for Deploy to Netlify
[template]
  # If you want the user to see the full config screen (with env vars, repo details, etc.)
  full = true

[[template.environment]]
name = "BETTER_AUTH_SECRET"
required = true
default = ""
description = "Signs JWTs for authentication. Run 'openssl rand -base64 32' in your terminal to generate"

[[template.environment]]
name = "DB_ENCRYPTION_KEY"
required = true
default = ""
description = "Encrypts Schwab API credentials before database storage. Run 'openssl rand -base64 32' in your terminal to generate"

[[template.environment]]
name = "CRON_KEY"
required = true
default = ""
description = "Protects scheduled worker API endpoints. Run 'openssl rand -base64 32' in your terminal to generate"

[[template.environment]]
name = "INDIVIDUAL_USE"
required = true
default = "true"
description = "Set to 'true' for single-user mode (recommended for personal deployments)"

[[template.environment]]
name = "SCHWAB_CLIENT_ID"
required = false
default = ""
description = "Schwab API client ID (required for Schwab integration - see SCHWAB_SETUP.md)"

[[template.environment]]
name = "SCHWAB_CLIENT_SECRET"
required = false
default = ""
description = "Schwab API client secret (required for Schwab integration - see SCHWAB_SETUP.md)"

[[template.environment]]
name = "RESEND_API_KEY"
required = false
default = ""
description = "Resend API key for email notifications (optional)"


# Redirect rules for SPA
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

# Environment variables (set these in Netlify dashboard)
# DATABASE_URL = "your-neon-postgres-connection-string" # Automatically set by @netlify/neon
# BETTER_AUTH_SECRET = "your-auth-secret"
# CRON_KEY = "your-cron-key"
# DB_ENCRYPTION_KEY = "your-32-byte-encryption-key" # Encrypts Schwab API credentials
